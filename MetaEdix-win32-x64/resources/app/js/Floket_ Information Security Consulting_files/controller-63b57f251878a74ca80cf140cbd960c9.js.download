webpackJsonp([4],{"15zH":function(e,t,r){"use strict";function n(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}function a(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var o=r("kX8J"),i=r("kSHn"),c=r("w+Lg"),s=r("afZ+"),u=r("iC45"),l=r("IhPv"),d=r("oTrx"),p=r("ymeh"),f=r("8f5h"),b=r("VfJ5"),m=r("7haU"),h=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_=["connectEnd","connectStart","domainLookupEnd","domainLookupStart","duration","fetchStart","redirectEnd","redirectStart","requestStart","responseEnd","responseStart","secureConnectionStart","startTime"],v=function(e){var t=e;return Object(d.h)(t,_)},j=function(e){if(e&&window.performance&&window.performance.getEntriesByName){var t=window.performance.getEntriesByName(e);if(!t||0===t.length)return{errorMsg:"No resource timing entries found"};return v(t[t.length-1])}},O=function(e,t){var r={};if(!e)return r;return function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";Object.keys(t).forEach(function(a){var o=(n+"["+a+"]").replace(/^-/,""),i=t[a];null!=i&&("object"===(void 0===i?"undefined":y(i))?e(i,o):r[o]=i)})}(e,t),r},g=function(e){return e.hasOwnProperty("card")?"card":e.hasOwnProperty("bank_account")?"bank_account":e.hasOwnProperty("pii")?"pii":e.hasOwnProperty("apple_pay")?"apple_pay":"unknown"},k=function(e,t,r,n){if(n.getResponseHeader&&n.responseURL){var a=g(r),o=(new Date).getTime(),i=j(n.responseURL);m.a.log("rum.stripejs",h({requestId:n.getResponseHeader("Request-Id"),tokenType:a,url:t,status:n.status,start:e,end:o},O(i,"resourceTiming"),{version:3,paymentUserAgent:b.a}),"")}},w=k,S="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},E=function(e){if(e&&"object"===(void 0===e?"undefined":S(e))){var t=e.addressLines,r=e.givenName,n=e.familyName,a=e.locality,o=e.administrativeArea,i=e.postalCode,c=e.countryCode,s=[r,n].filter(function(e){return e});return{name:s.length?s.join(" "):void 0,address_line1:t&&Array.isArray(t)?t[0]:void 0,address_line2:t&&Array.isArray(t)?t.slice(1).join(", "):void 0,address_city:a,address_state:o,address_zip:i,address_country:c}}return{}},I=E,P=function(e){var t=e.match(/^(pi_[^_]+)_secret_[^-]+$/);return t?{id:t[1],clientSecret:t[0]}:null},T=function(e,t){if("string"!=typeof e)return Object(u.j)("a client_secret string",e,t);var r=P(e);return null===r?Object(u.j)("a client secret of the form pi_${id}_secret_${secret}",e,t):Object(u.x)(r,[])},C=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},F={pi_ready:Object.freeze({object:"payment_intent",livemode:!1,created:(new Date).getTime(),amount:100,currency:"USD",id:"pi_ready",client_secret:"pi_ready_secret_abcd",client_status:"requires_source"}),pi_invalid:{object:"payment_intent",livemode:!1,created:(new Date).getTime(),amount:100,currency:"USD",id:"pi_invalid",client_secret:"pi_invalid_secret_abcd",client_status:"invalid"},pi_sessionEnd:{object:"payment_intent",livemode:!1,created:(new Date).getTime(),amount:100,currency:"USD",id:"pi_sessionEnd",client_secret:"pi_sessionEnd_secret_abcd",client_status:"session_end"}},N=function(e,t){return C({id:e.id,client_secret:e.client_secret,object:e.object,livemode:e.livemode,created:e.created,amount:e.amount,currency:e.currency},t)},A={},D=function(e,t){var r=Object(u.y)(T,e,"retrieve paymentIntent"),n=r.value,a=n.id,o=n.clientSecret,c=F[a];if(!c||c.client_secret!==o)return i.a.resolve({type:"error",error:{message:"unknown_object"}});var s=A[a];return s?ee.retrieve(s.id,{client_secret:s.secret,key:t.key,_stripe_account:t._stripe_account}).then(function(e){return"error"===e.type?{type:"error",error:{message:"Failed to request updated 3ds source",payment_intent:c}}:"failed"===e.object.status?{type:"error",error:{message:"3ds authentication failed",payment_intent:c}}:{type:"object",object:N(c,{client_status:"session_end"})}}):i.a.resolve({type:"object",object:c})},R=function(e,t){var r=Object(u.y)(T,e,"retrieve paymentIntent"),n=r.value,a=n.id,o=F[a];return o?"requires_confirmation"!==o.client_status&&"requires_source"!==o.client_status?i.a.resolve({type:"error",error:{code:"cant_confirm"}}):ee.create(C({},t.source,{key:t.key,_stripe_account:t._stripe_account})).then(function(e){if("error"===e.type)return{type:"error",error:e.error};var r=e.object;return"recommended"===r.card.three_d_secure||"required"===r.card.three_d_secure?ee.create({type:"three_d_secure",amount:o.amount,currency:o.currency,three_d_secure:{card:r.id},redirect:{return_url:"https://js.stripe.com/v3/hooks-redirect-inner.html"},key:t.key,_stripe_account:t._stripe_account}).then(function(e){return"error"===e.type?e:(A[a]={id:e.object.id,secret:e.object.client_secret},{type:"object",object:N(o,{client_status:"requires_source_action",required_source_action:{type:"authorize_with_url",source:e.object,value:{url:e.object.redirect.url,allow_embed:!0}}})})}):{type:"object",object:N(o,{client_status:"session_end"})}}):i.a.resolve({type:"error",error:{code:"not_found"}})};r.d(t,"g",function(){return W}),r.d(t,"h",function(){return Q}),r.d(t,"c",function(){return ee}),r.d(t,"b",function(){return te}),r.d(t,"f",function(){return re}),r.d(t,"a",function(){return ae}),r.d(t,"e",function(){return oe}),r.d(t,"d",function(){return ce});var z,M="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},q=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},x={email:Object(u.p)(u.s),usage:Object(u.p)(u.s)},L={city:Object(u.p)(u.s),country:Object(u.p)(u.s),line1:Object(u.p)(u.s),line2:Object(u.p)(u.s),postal_code:Object(u.p)(u.s),state:Object(u.p)(u.s)},U=q({},L,{town:Object(u.p)(u.s)}),B={address:Object(u.p)(Object(u.e)(L)),dob:Object(u.p)(Object(u.e)({day:Object(u.h)(1,31),month:Object(u.h)(1,12),year:u.m})),first_name:Object(u.p)(u.s),last_name:Object(u.p)(u.s),maiden_name:Object(u.p)(u.s),verification:Object(u.p)(Object(u.e)({document:Object(u.p)(Object(u.q)(u.s,Object(u.e)({front:Object(u.p)(u.s),back:Object(u.p)(u.s)})))}))},V={card:{name:Object(u.p)(u.s),address_line1:Object(u.p)(u.s),address_line2:Object(u.p)(u.s),address_city:Object(u.p)(u.s),address_state:Object(u.p)(u.s),address_zip:Object(u.p)(u.s),address_country:Object(u.p)(u.s),currency:Object(u.p)(u.s),number:Object(u.k)("Elements"),cvc:Object(u.k)("Elements"),exp_month:Object(u.k)("Elements"),exp_year:Object(u.k)("Elements")},pii:{personal_id_number:Object(u.p)(u.s)},bank_account:{account_number:Object(u.p)(Object(u.d)([s.b.sepaIban],"The 'account_number' parameter is not supported when creating a token with the '"+s.b.sepaIban+"' Element")(u.s)),country:Object(u.p)(Object(u.d)([s.b.sepaIban],"The 'country' parameter is not supported when creating a token with the '"+s.b.sepaIban+"' Element")(u.s)),currency:Object(u.p)(u.s),routing_number:Object(u.p)(Object(u.d)([s.b.sepaIban],"The 'routing_number' parameter is not supported when creating a token with the '"+s.b.sepaIban+"' Element")(u.s)),account_holder_name:Object(u.p)(u.s),account_holder_type:Object(u.p)(u.s)},account:{legal_entity:Object(u.p)(Object(u.e)(q({},B,{additional_owners:Object(u.p)(Object(u.a)(Object(u.e)(B))),address_kana:Object(u.p)(Object(u.e)(U)),address_kanji:Object(u.p)(Object(u.e)(U)),business_name:Object(u.p)(u.s),business_name_kana:Object(u.p)(u.s),business_name_kanji:Object(u.p)(u.s),business_tax_id:Object(u.p)(u.s),business_vat_id:Object(u.p)(u.s),first_name_kana:Object(u.p)(u.s),first_name_kanji:Object(u.p)(u.s),gender:Object(u.p)(Object(u.o)("male","female")),last_name_kana:Object(u.p)(u.s),last_name_kanji:Object(u.p)(u.s),personal_address:Object(u.p)(Object(u.e)(L)),personal_address_kana:Object(u.p)(Object(u.e)(U)),personal_address_kanji:Object(u.p)(Object(u.e)(U)),personal_id_number:Object(u.p)(u.s),phone_number:Object(u.p)(u.s),ssn_last_4:Object(u.p)(u.s),tax_id_registrar:Object(u.p)(u.s),type:Object(u.p)(Object(u.o)("individual","company"))}))),tos_shown_and_accepted:Object(u.p)(Object(u.f)(!0))}},J=function(e){var t=x,r=V[e];return Object(u.r)(q({},t,r,a({},e,Object(u.p)(Object(u.r)(r)))))},W=function(e,t,r){var n=(new Date).getTime(),a=""+c.a+e;return Object(o.a)({url:a,method:t,data:r}).then(function(e){w(n,a,r,e);var t=JSON.parse(e.responseText);return 200===e.status?{type:"object",object:t}:{type:"error",error:t.error}})},H=function(e){return function(t){return W(e,"POST",t)}},K=function(e){return function(t,r){return W(e+"/"+t,"GET",r)}},Z=new RegExp(""+c.c,"g"),Y=function(e){return Object(d.d)(e,function(e){return e.replace(Z,"")})},G=function(e){var t=e.cardExpiry?e.cardExpiry.replace(new RegExp("^"+c.c),"").split(" / "):[],r={number:e.cardNumber&&Object(p.a)(e.cardNumber),cvc:e.cardCvc||void 0,exp_month:t[0],exp_year:t[1]},n=e.postalCode?{address:{postal_code:e.postalCode}}:{},a={address_zip:e.postalCode||void 0};return{card:Object(d.i)(r,function(e,t){return void 0!==t}),owner:Object(d.i)(n,function(e,t){return void 0!==t}),legacyOwner:Object(d.i)(a,function(e,t){return void 0!==t})}},$=(z={},a(z,s.b.cardNumber,"number"),a(z,s.b.cardExpiry,"exp"),a(z,s.b.cardCvc,"cvc"),a(z,s.b.postalCode,"zip"),z),X=function(e){return e.filter(function(e){return $[e]}).map(function(e){return $[e]}).join(",")},Q=function(e,t){if("error"===e.type&&e.error&&"object"===M(e.error))return{type:"error",error:e.error};if("object"===e.type&&e.object){return{type:"object",object:Object(u.y)(t,e.object,"[internal request]").value}}throw new Error("Error parsing result from an internal request.")},ee={transformElementData:function(e,t,r){var n=f.a[e],a=r&&r.length?X(r):void 0,o=Y(t);switch(n){case"card":var i=G(o);return{type:f.e.card,data:{card:i.card,owner:i.owner},pastedFields:a};case"sepa_debit":return{type:f.e.sepa_debit,data:{sepa_debit:{iban:Object(p.b)(o[s.b.sepaIban])}}};case"ideal":return{type:f.e.ideal,data:{ideal:{bank:o[s.b.idealBank]}}};default:return Object(l.a)(n)}},transformData:function(e,t){return{type:e,data:t}},retrieve:K("sources"),create:H("sources")},te={retrieve:D,confirm:R},re={transformElementData:function(e,t,r){switch(f.b[e]){case f.f.card:var n=G(Y(t)),a=n.card,o=n.legacyOwner,i=r&&r.length?X(r):void 0;return{data:{card:q({},a,o)},pastedFields:i,type:f.f.card,warnings:[]};case f.f.bank_account:return{data:{bank_account:t.betaSepaIban?{account_number:Object(p.b)(t.betaSepaIban),country:t.betaSepaIban.slice(0,2)}:{}},type:"bank_account",warnings:[]};default:throw new Error("No corresponding token type for this Element: "+e+".")}},transformData:function(e,t,r){if("apple_pay"===e){var o=t.token,i=t.currencyCode,c=t.total,s=o;if("simulated identifier"===s.transactionIdentifier.toLowerCase()){var l=c&&c.amount?c.amount:"0",p=i?i.toLowerCase():"usd";s=q({paymentData:""},s,{cardNumber:"4242424242424242",transactionIdentifier:"ApplePayStubs~4242424242424242~"+l+"~"+p+"~"+Math.random().toString(36).slice(-10)})}return{type:f.f.card,data:{pk_token:JSON.stringify(s.paymentData),pk_token_transaction_id:s.transactionIdentifier,pk_token_payment_network:s.paymentMethod.network,pk_token_instrument_name:s.paymentMethod.displayName,card:t.billingContact?I(t.billingContact):{}},warnings:[]}}var b=Object(u.y)(u.o.apply(void 0,n(Object.keys(V))),e,"token type"),m=b.value,h=Object(u.y)(J(m),t,"token creation parameter",{element:r}),y=h.value||{},_=y[e],v=Object.keys(V[m]),j=q(a({},m,q({},Object(d.h)(y,v),_)),Object(d.g)(y,[].concat(n(v),[e])));return{type:e,data:Object(d.e)({},j),warnings:h.warnings}},create:H("tokens")},ne={object:u.s,session:u.s},ae={create:H("apple_pay/sessions"),transforms:Object(u.r)(ne)},oe={create:H("3ds2_pilot/verifications"),check:function(e,t){return W("3ds2_pilot/verifications/"+e+"/check","POST",t)},transforms:Object(u.q)(Object(u.e)({result:Object(u.f)("success"),value:Object(u.r)({token:u.s,status:u.s,base_notification_url:u.s})}),Object(u.e)({result:Object(u.f)("rate_limited"),value:Object(u.f)(null)}))},ie={id:u.s,object:u.s,brand:u.s,pretty_bank_name:Object(u.l)(u.s),class_type:Object(u.l)(u.s),country_code:Object(u.l)(u.s),use:Object(u.l)(u.s)},ce={get:K("3ds2_pilot/bins"),transforms:Object(u.r)(ie)}},4:function(e,t,r){r("hC4F"),e.exports=r("bnjt")},"7haU":function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var i=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.name=e,this.params=t},c=i,s=r("w+Lg"),u=r("ZAKj"),l=r("oTrx"),d=function(e){return(null!=e&&"function"==typeof e.toString?e.toString():"").replace(/(\d\s*\+*%*){6}[\d\s+%]+/g,"<sanitized>")},p=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},f=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},m=function(e){var t={};return function e(r){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";Object.keys(r).forEach(function(a){var o=(n+"-"+a).replace(/^-/,""),i=r[a];null!=i&&("object"===(void 0===i?"undefined":b(i))?e(i,o):t[o]=i)})}(e),t},h={features:!0,key:!0,referrer:!0,stripe_js_id:!0,event_count:!0,timestamp:!0,frame_width:!0,version:!0,event:!0,resource_timings:!0,mount_duration:!0,dom_complete:!0,dom_interactive:!0,source_id:!0,token_id:!0,start:!0,end:!0},y=function(){function e(){n(this,e)}return f(e,[{key:"request",value:function(e){(new Image).src=s.e+"?"+e}},{key:"send",value:function(e){var t=p({event:e.name},m(e.params)),r=Object(l.d)(t,function(e,t){return e.length>8e3?"<toolong>":0===t.indexOf("resourceTiming[")?e:h[t.split("-")[0]]?e:d(e)});this.request(Object(u.a)(r))}}]),e}(),_=y,v=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),j=(function(){function e(){a(this,e)}v(e,[{key:"send",value:function(e){var t=e.params.element?"("+e.params.element+")":"";window.console&&console.group&&(console.groupCollapsed("%cLogger"+t+": "+e.name,"color: blue"),console.info(JSON.stringify(e.params,null,"\t")),console.groupEnd())}}])}(),Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}),O=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),g=function(){function e(t){o(this,e),this.transports=t,this.eventCount=0}return O(e,[{key:"log",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"elements.",n={event_count:++this.eventCount,timestamp:Date.now(),frame_width:window.innerWidth,version:s.g},a=j({},n,t);this.transports.forEach(function(t){t.send(new c(""+r+e,a))})}}]),e}(),k=[];k.push(new _);var w=new g(k);t.a=w},"8f5h":function(e,t,r){"use strict";function n(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}r.d(t,"e",function(){return c}),r.d(t,"f",function(){return s}),r.d(t,"c",function(){return u}),r.d(t,"d",function(){return l}),r.d(t,"a",function(){return d}),r.d(t,"b",function(){return p});var a,o,i=r("afZ+"),c={card:"card",ideal:"ideal",sepa_debit:"sepa_debit",three_d_secure:"three_d_secure"},s={account:"account",card:"card",bank_account:"bank_account",pii:"pii"},u={failed:"failed",succeeded:"succeeded",unconfirmed:"unconfirmed"},l={code_verification:"code_verification",none:"none",receiver:"receiver",redirect:"redirect"},d=(a={},n(a,i.b.card,c.card),n(a,i.b.cardNumber,c.card),n(a,i.b.cardExpiry,c.card),n(a,i.b.cardCvc,c.card),n(a,i.b.postalCode,c.card),n(a,i.b.sepaIban,c.sepa_debit),n(a,i.b.idealBank,c.ideal),a),p=(o={},n(o,i.b.card,s.card),n(o,i.b.cardNumber,s.card),n(o,i.b.cardExpiry,s.card),n(o,i.b.cardCvc,s.card),n(o,i.b.postalCode,s.card),n(o,i.b.sepaIban,s.bank_account),o)},VfJ5:function(e,t,r){"use strict";r.d(t,"a",function(){return o}),r.d(t,"b",function(){return i});var n=r("w+Lg"),a="stripe.js/"+n.g,o=a+"; stripe-js-v3/"+n.g,i=o+"; raw-card"},bnjt:function(e,t,r){"use strict";function n(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}function a(e,t){var r={};for(var n in e)t.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(e,n)&&(r[n]=e[n]);return r}function o(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}Object.defineProperty(t,"__esModule",{value:!0});var i=r("IhPv"),c=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];if(window.console){var n=window.console.warn;n.apply?n.apply(window.console,t):n(t.join(" "))}},s=c,u=r("kSHn"),l=r("x38n"),d=r("iC45"),p=r("/c/z"),f=r("BsYB"),b=r("oTrx"),m=r("11CF"),h=r("B4vs"),y=r("PjFh"),_=r("vN1N"),v=r("afZ+"),j=r("iwWn"),O=r("0nsC"),g=r("ZBjb"),k=r("w+Lg"),w=r("2XcD"),S=r("C6qp"),E=r("7haU"),I=function(e,t,r,n){var a=n-1;return new u.a(function n(o,i){return e().then(function(e){t(e)?o(e):a?(a--,setTimeout(n,r,o,i)):o(e)},function(e){i(e)})})},P=I,T=r("8f5h"),C=function(e){var t=e.source,r=t.flow;switch(t.status){case"pending":switch(r){case T.d.redirect:return{source:t,authorizationStatus:T.c.unconfirmed,nextAction:"redirect"};default:return{source:t,authorizationStatus:T.c.unconfirmed,nextAction:"none"}}case"chargeable":case"consumed":return{source:t,authorizationStatus:T.c.succeeded,nextAction:"none"};case"failed":case"canceled":default:return{source:t,authorizationStatus:T.c.failed,nextAction:"none"}}},F=C,N=r("VfJ5"),A=r("15zH"),D="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},R=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},z=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),M=[T.f.account,T.f.bank_account,T.f.pii,"apple_pay"],q=function(e){return{object_id:e.id,object_kind:e.object,object_type:e.type,object_livemode:e.livemode}},x=function(){function e(e){var t=this;this.warn=function(){t.shouldWarn&&s.apply(void 0,arguments)},this.reportFetchResult=function(e,r,n,a){switch(r.type){case"error":t.report(e+".server_error",{error:r.error});break;case"object":t.report(e+".success",R({},q(r.object),a));break;default:Object(i.a)(r)}},this.fetchResultToPublicApi=function(e,t,r){switch(t.type){case"error":var n=t.error;return{error:Object(j.a)(n,r||"auto")};case"object":return o({},e,t.object);default:return Object(i.a)(t)}},this.requestState=function(e){var r=Object(f.b)(),n=new u.a(function(n,a){t.requests[r]=R({},t.requests[r],{resolve:n,reject:a}),t._isFrameReady(e)?t.sendMessage(e,{action:"stripe-controller-request",payload:{nonce:r}}):n(void 0)});return t.requests[r]=R({},t.requests[r],{promise:n}),n};var r=Object(m.a)(e),n=r.origin,c=a(r,["origin"]),l=Object(d.y)(Object(d.r)({controllerId:Object(d.p)(d.s),apiKey:Object(d.p)(d.s),stripeAccount:Object(d.p)(d.s),referrer:Object(d.p)(d.s),stripeJsId:Object(d.p)(d.s),features:Object(d.p)(S.n)}),c,"[internal interface]",{origin:k.d||String(n)}),p=l.value,y=p.apiKey,_=p.stripeAccount,v=p.controllerId,O=p.stripeJsId,g=p.referrer;if(!y||!O||"string"!=typeof g||!v)throw new Error("It looks like Stripe.js was not loaded correctly");if(this.apiKey=y,this.stripeAccount=_,this.stripeJsId=O,this.id=window.name,this.controllerId=v,this.referrer=k.f||g,this.shouldWarn=Object(h.b)(y)===h.a.test,this.frames={},this.groups={},this.requests={},p.features){this.features=Object(b.d)(p.features,function(e){return"true"===e})}this._setupPostMessage(),Object(w.a)(this),this._sendParentMessage({action:"stripe-controller-load",payload:{}}),this.report("controller.load")}return z(e,[{key:"report",value:function(e){E.a.log(e,R({},arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{features:this.features,key:this.apiKey,referrer:this.referrer,stripe_js_id:this.stripeJsId}))}},{key:"action",value:function(e,t,r){var n=this;if(v.a[e]){var a=t&&"object"===(void 0===t?"undefined":D(t))?t:{},o=void 0,c=null;switch(e){case"TOKENIZE":c=t,o=this.actionTokenize;break;case"FETCH_LOCALE":o=this.actionFetchLocale;break;case"UPDATE_CSS_FONTS":o=this.actionUpdateCssFonts;break;case"CREATE_SOURCE":c=t,o=this.actionCreateSource;break;case"AUTHORIZE_SOURCE":o=this.actionAuthorizeSource;break;case"GET_AUTHORIZATION_STATUS":o=this.actionGetAuthorizationStatus;break;case"RETRIEVE_SOURCE":o=this.actionRetrieveSource;break;case"RETRIEVE_PAYMENT_INTENT":o=this.actionRetrievePaymentIntent;break;case"CONFIRM_PAYMENT_INTENT":o=this.actionConfirmPaymentIntent;break;case"CREATE_APPLE_PAY_SESSION":o=this.actionCreateApplePaySession;break;default:return Object(i.b)(e),this.report("fatal.unhandled_action",{type:e,options:t}),u.a.reject(new l.a("Unhandled action: "+e))}return this.report(e.toLowerCase(),c?{options:c,element:c.elementName}:{}),new u.a(function(e){e(o.call(n,a,r))})}return this.report("fatal.unknown_action",{type:e,options:t}),u.a.reject(new l.a("Unknown action: "+e))}},{key:"innerAction",value:function(e,t,r){var n=this;if(k.b[e]){var a=t&&"object"===(void 0===t?"undefined":D(t))?t:{},o=void 0;switch(e){case"TOKENIZE":o=this.actionTokenizeForInner;break;case"CREATE_3DS_PILOT_VERIFICATION":o=this.actionCreate3DSPilotVerification;break;case"CHECK_3DS_PILOT_VERIFICATION":o=this.actionCheck3DSPilotVerification;break;case"RETRIEVE_3DS_PILOT_BIN":o=this.actionRetrieve3DSPilotBin;break;default:return Object(i.b)(e),this.report("fatal.unhandled_action",{type:e,options:t}),u.a.reject(new l.a("Unhandled action: "+e))}return this.report(e.toLowerCase(),{element:t.elementName}),new u.a(function(e){e(o.call(n,a,r))})}return this.report("fatal.unknown_action",{type:e,options:t}),u.a.reject(new l.a("Unknown action: "+e))}},{key:"handleFetchError",value:function(e,t){if("NetworkError"===e.name)return{error:{type:"api_connection_error",message:Object(g.a)(t||"auto","errors.type.api_connection_error")}};throw e}},{key:"authenticationParams",value:function(){return{key:this.apiKey,_stripe_account:this.stripeAccount}}},{key:"paymentMetadata",value:function(){return{payment_user_agent:N.a,referrer:this.referrer}}},{key:"dataForSource",value:function(e,t){var r=e.data,n=e.locale,o=e.frameId,i=e.elementName,c=r&&"object"===(void 0===r?"undefined":D(r))?r:{},s=c.type,u=c.mids,d=a(c,["type","mids"]);if(o&&"string"==typeof o)return this.dataForSourceFromElement({frameId:o,mids:u,elementName:i,data:R({type:s},d)},t);if("string"==typeof s){if("card"===s){var p=d.card,f=d.token,b=!!f,m=!!p&&(p.masterpass||p.visa_checkout);if(!b&&!m)return this.dataForSourceData({data:R({type:s},d),elementName:i,locale:n,mids:u},t).then(function(e){return R({},e,{payment_user_agent:N.b})});if(m){var h=Object.keys(p);if(1!==h.length){var y=h.filter(function(e){return"visa_checkout"!==e&&"masterpass"!==e});throw new l.a("Unexpected parameters for "+(p.visa_checkout?"Visa Checkout":"Masterpass")+": "+y.join(", "))}}}return this.dataForSourceData({data:R({type:s},d),elementName:i,locale:n,mids:u},t)}throw new l.a("Please provide a valid Source type when creating a source.")}},{key:"dataForSourceFromElement",value:function(e,t){var r=this,n=e.mids,a=e.data,o=e.elementName;return this._retrieveElementData(e.frameId).then(function(e){if("error"===e.type){var i=e.error;return r.report("create_source.validation_error",{error:i,element:o}),{error:i}}var c=e.element,s=e.locale,u=e.value,l=e.pastedFields,d=A.c.transformElementData(c,u,l),p=d.data,f=d.type,m=d.pastedFields?{pastedFields:d.pastedFields}:{},h=Object(b.e)({type:f},a,p);return r.dataForSourceData(R({data:h,locale:s,elementName:c,mids:n},m),t)})}},{key:"dataForSourceData",value:function(e){var t=this,r=e.mids,n=e.data,a=e.pastedFields,o=A.c.transformData(n.type,n),i=o.data;return new u.a(function(e){e(R({},i,r,{pasted_fields:a},t.paymentMetadata()))})}},{key:"actionCreateSource",value:function(e,t){var r=this,n=e.locale,a=e.elementName;return this.dataForSource(e,t).then(function(e){return e.error?e:A.c.create(R({},e,r.authenticationParams())).then(function(e){return r.reportFetchResult("create_source",e,n,{element:a}),r.fetchResultToPublicApi("source",e,n)}).catch(function(e){return r.handleFetchError(e,n)})})}},{key:"actionAuthorizeSource",value:function(e){var t=e.source;if(t&&"object"===(void 0===t?"undefined":D(t))&&t.status)return u.a.resolve(F({source:t}));throw new l.a("Please supply a Source object (from stripe.createSource(...)) to authorize the Source.")}},{key:"actionGetAuthorizationStatus",value:function(e){var t=this;if(!e.source||!e.source.id||!e.source.client_secret)throw new l.a("Please supply an object with the shape {source: {id, client_secret}} to get the authorization status of the corresponding source.");var r=e.source,n=r.id,a=r.client_secret;return new u.a(function(e){P(function(){return A.c.retrieve(n,R({client_secret:a},t.authenticationParams())).then(function(e){if("error"===e.type)return{error:e.error};var t=e.object;return{authorizationStatus:F({source:t}).authorizationStatus,source:t}})},function(e){return e.authorizationStatus&&"unconfirmed"!==e.authorizationStatus},1e3,k.h).then(e).catch(function(e){return t.handleFetchError(e)})})}},{key:"actionRetrieveSource",value:function(e){var t=this;if(!e.source||!e.source.id||!e.source.client_secret)throw new l.a("Please supply an object with the shape {source: {id, client_secret}} to get the authorization status of the corresponding source.");var r=e.source;return A.c.retrieve(r.id,R({client_secret:r.client_secret},this.authenticationParams())).then(function(r){return t.reportFetchResult("retrieve_source",r,e.locale),t.fetchResultToPublicApi("source",r)}).catch(function(e){return t.handleFetchError(e)})}},{key:"actionRetrievePaymentIntent",value:function(e){var t=this;return A.b.retrieve(e.intentSecret,this.authenticationParams()).then(function(e){return t.reportFetchResult("retrieve_payment_intent",e,"auto"),t.fetchResultToPublicApi("paymentIntent",e)}).catch(this.handleFetchError)}},{key:"actionConfirmPaymentIntent",value:function(e,t){var r=this,n=e.intentSecret,a=e.source,o=e.options,i=a.elementName,c=a.locale;return this.dataForSource(a,t).then(function(e){return e.error?e:A.b.confirm(n,R({source:e},r.authenticationParams(),o),r,t)}).then(function(e){return r.reportFetchResult("confirm_payment_intent",e,c,{element:i}),r.fetchResultToPublicApi("paymentIntent",e,c)}).catch(function(e){return r.handleFetchError(e,c)})}},{key:"actionCreateApplePaySession",value:function(e){var t=this,r=e.locale,n=e.usesButtonElement;return A.a.create(R({},e.data,this.authenticationParams())).then(function(e){return t.reportFetchResult("create_apple_pay_session",e,r,{usesButtonElement:n}),Object(A.h)(e,A.a.transforms)})}},{key:"actionUpdateCssFonts",value:function(e){var t=this,r=e.fonts,n=e.groupId;if(n&&this.groups[n]){this.groups[n].forEach(function(e){t.sendMessage(e,{action:"stripe-controller-update",payload:{fonts:r}})})}}},{key:"actionFetchLocale",value:function(e){var t=this,r=e.locale;if("string"==typeof r)return Object(O.c)(r).then(function(){return{locale:r}},function(e){throw t.report("error.locale_load_error",{error:e,locale:r}),e});throw new l.a("No locale option provided.")}},{key:"actionTokenize",value:function(e,t){var r=e.type,n=e.frameId,o=e.locale,i=e.mids,c=e.elementName,s=a(e,["type","frameId","locale","mids","elementName"]);if(r){return this.actionTokenizeWithData({type:Object(d.y)(d.o.apply(void 0,M),r,"token type").value,locale:o,elementName:c,data:s,mids:i},t)}if(n)return this.actionTokenizeWithElement({frameId:n,elementName:c,data:s,mids:i},t);throw new l.a("You must provide a Stripe Element or a valid token type to create a Token.")}},{key:"actionTokenizeForInner",value:function(e,t){return this.actionTokenizeWithData({type:e.type,elementName:e.elementName,elementData:{card:e.card},data:a(e,["type","card","elementName"])},t)}},{key:"actionTokenizeWithElement",value:function(e,t){var r=this,n=e.elementName,a=e.data,o=e.mids;return this._retrieveElementData(e.frameId).then(function(e){if("error"===e.type){var i=e.error;return r.report("tokenize.validation_error",{error:i,element:n}),{error:i}}var c=e.value,s=e.locale,u=e.element,l=e.pastedFields,d=e.clientCardBrand,p=A.f.transformElementData(u,c,l),f=p.type,b=p.data,m=p.pastedFields;return p.warnings.forEach(function(e){return r.warn(e)}),r.actionTokenizeWithData({type:f,locale:s,elementName:u,mids:o,pastedFields:m,clientCardBrand:d,elementData:b,data:a},t)})}},{key:"actionTokenizeWithData",value:function(e){var t=this,r=e.locale,n=e.elementName,a=e.mids,o=e.type,i=e.data,c=e.elementData,s=e.pastedFields,u=A.f.transformData(o,i,n),l=u.data;u.warnings.forEach(function(e){return t.warn(e)});var d=Object(b.e)({},l,c||{});return A.f.create(R({},d,a,this.paymentMetadata(),this.authenticationParams(),{pasted_fields:s})).then(function(a){if("error"===a.type){var o=a.error;t.report("tokenize.server_error",{error:o,element:n});return{error:Object(j.a)(o,r||"auto")}}var i=a.object,c="card"===i.type?{has_postal_code:!!i.card.address_zip,card_country:i.card.country,card_brand_api:i.card.brand,card_brand_client:e.clientCardBrand}:null;return t.report("tokenize.success",R({},q(i),{element:n},c)),{token:i}}).catch(function(e){return t.handleFetchError(e,r)})}},{key:"actionCreate3DSPilotVerification",value:function(e){var t=e.locale,r=e.phoneNumber,n=e.witness,a=e.merchantName;return A.e.create(R({},this.authenticationParams(),{locale:t,merchant_name:a,phone_number:r,witness:n}))}},{key:"actionCheck3DSPilotVerification",value:function(e){var t=e.verificationToken,r=e.code;return A.e.check(t,R({},this.authenticationParams(),{code:r}))}},{key:"actionRetrieve3DSPilotBin",value:function(e){return A.d.get(e.bin,this.authenticationParams())}},{key:"_retrieveElementData",value:function(e){var t=void 0,r=void 0,n=this.frames[e];if(n){var a=n.group;return this.requestStateFromFrames(a?this.groups[a]:[e]).then(function(n){var a={},o={},i=void 0;if(0===n.filter(function(t){return t&&t.frameId===e}).length)throw new l.a("We could not retrieve data from the specified Element.\n              Please make sure the Element you are attempting to use is still mounted.");for(var c=0;c<n.length;c+=1){var s=n[c];if(s){var u=s.meta,d=s.value,p=s.locale,f=s.element,b=s.frameId,m=s.pastedFields;if(u.brand&&(i=u.brand),b===e&&(t=p,r=f),u.error)return{type:"error",error:u.error};a=R({},a,d),o=R({},o,m)}}return R({type:"data",value:a,locale:t,element:r,pastedFields:Object.keys(o)},i?{clientCardBrand:i}:{})},function(e){throw e})}throw new l.a("Please use the same instance of `Stripe` you used to create this Element to create your Source or Token.")}},{key:"requestStateFromFrames",value:function(e){return u.a.all(e.map(this.requestState))}},{key:"sendMessage",value:function(e,t){this._sendMessage({message:t,type:"controller",frameId:e,controllerId:this.controllerId})}},{key:"_sendMessage",value:function(e){var t=this.frames[e.frameId].queuedMessages;this._isFrameReady(e.frameId)?Object(y.b)(e):t.push(e)}},{key:"_isFrameReady",value:function(e){var t=this.frames[e].loaded;return!!Object(_.a)(e)&&t}},{key:"_actionError",value:function(e,t){this._sendParentMessage({action:"stripe-user-action-error",payload:{nonce:e,error:t}})}},{key:"_actionComplete",value:function(e,t){this._sendParentMessage({action:"stripe-user-action-complete",payload:{nonce:e,result:t}})}},{key:"_setupPostMessage",value:function(){var e=this;window.addEventListener("message",function(t){var r=t.data,a=t.origin,o=Object(y.a)(r);if(o){var i=o.message;"stripe-controller-report"===i.action?e.report(i.payload.event,i.payload.data):"stripe-controller-warn"===i.action?e.warn.apply(e,n(i.payload.args)):Object(p.a)(v.d,a)?e._handleInnerMessage(o,a):e._handleOuterMessage(o,a)}})}},{key:"_sendParentMessage",value:function(e){Object(y.b)({message:e,type:"inner",frameId:this.id,controllerId:this.controllerId})}},{key:"_handleOuterMessage",value:function(e,t){var r=this,a=e.message;switch(a.action){case"stripe-user-createframe":var o=a.payload,i=o.newFrameId,c=o.groupId;if(i&&(this.frames[i]={loaded:!1,queuedMessages:[],group:c},c)){this.groups[c]=[].concat(n(this.groups[c]||[]),[i])}break;case"stripe-user-action":var s=a.payload,u=s.type,l=s.nonce;this.action(u,s.options,t).then(function(e){return r._actionComplete(l,e)},function(e){v.a[u]&&r.report("error."+u.toLowerCase(),{error:e}),r._actionError(l,e.message)});break;case"stripe-frame-unload":var d=a.payload.unloadedFrameId;this.frames[d]=R({},this.frames[d],{loaded:!1});break;case"stripe-frame-load":var p=a.payload.loadedFrameId,f=this.frames[p],b=f.queuedMessages;this.frames[p]=R({},f,{queuedMessages:[],loaded:!0}),b.forEach(function(e){return r._sendMessage(e)}),this.sendMessage(p,{action:"stripe-controller-init",payload:{}})}}},{key:"_handleInnerMessage",value:function(e,t){var r=this,n=e.frameId,a=e.message,o=n&&this.frames[n];if(o)switch(a.action){case"stripe-controller-request-complete":var i=a.payload,c=i.nonce,s=i.result,u=i.error;if(!c||"string"!=typeof c||!this.requests[c])break;var l=this.requests[c],d=l.resolve,p=l.reject;s&&"object"===(void 0===s?"undefined":D(s))?d(R({},s,{frameId:n})):u&&"object"===(void 0===u?"undefined":D(u))&&p(R({},u,{frameId:n})),delete this.requests[c];break;case"stripe-inner-action":this.innerAction(a.payload.type,a.payload.options,t).then(function(e){return r.sendMessage(n,{action:"stripe-inner-action-complete",payload:{nonce:a.payload.nonce,result:e}})},function(e){k.b[a.payload.type]&&r.report(a.payload.type.toLowerCase()+".error",{options:a.payload.options,error:e}),r.sendMessage(n,{action:"stripe-inner-action-error",payload:{nonce:a.payload.nonce,error:e.message}})});break;case"stripe-group-update":case"stripe-group-action":var f=o.group,b=f&&this.groups[f];b&&n&&-1!==b.indexOf(n)&&b.forEach(function(t){n!==t&&r._sendMessage(R({},e,{frameId:t,type:"controller"}))});break;default:this._handleOuterMessage(e,t)}else this._handleOuterMessage(e,t)}}]),e}(),L=x;!function(){var e=window.location.href.split("#")[1];new L(e)}()}},[4]);